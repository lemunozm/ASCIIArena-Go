@startuml

Arena *-left-> Ground
Arena *--> "0..n" Entity
Arena *--> "0..n" Spell

Mobile <|-- Entity
Mobile <|-- Spell
Entity -->"0..n" Skill
Entity *--"0..n" Buff

Control <|-- MobileControl
MobileControl <|-- EntityControl
MobileControl <|-- SpellControl
EntityControl <|-- PlayerControl

MobileControl o-left- Mobile
Entity o-right- EntityControl
Spell *-right- SpellControl

Control -left-> ArenaState
Arena -right-> ArenaState

Skill o-- SkillSpec
Spell o-- SpellSpec
Buff o-- BuffSpec
GameSpec *-up- "0..n" SkillSpec
GameSpec *-left- "0..n" SpellSpec
GameSpec *-up- "0..n" BuffSpec
SkillSpec o-- SpellSpec
SkillSpec o-- BuffSpec
SpellSpec o-right- BuffSpec

class Mobile {
    - position @set @get
    - direction @set @get
    - speed @set @get
    - moving @set @get
    + move(bool)
}

class Entity {
    - control @set @get
    - skill_list @get
    - buff_list @add @remove @get
    + Spell cast(skill)
}

class Spell {
    - control @get
}

class ArenaState {
    - step @get
    - ground @get
    - entity_list @get @add @remove
    - spell_list @get @add @remove
}

abstract Control {
    + update(state) = 0
}

class MobileControl {
    # controllable
    + update(state)
}

class EntityControl {
    + update(state)
}

class SpellControl {
    + update(state)
}

class PlayerControl {
    - last_movement_action
    - last_cast_skill_action
    + update(state)
    + move(direction)
    + cast(skill)
}

@enduml
